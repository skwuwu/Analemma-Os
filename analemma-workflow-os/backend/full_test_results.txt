2026-01-23 09:44:33,250 INFO Async required: tokens=4096, model=gemini-2.0-flash, force=False
2026-01-23 09:44:33,250 WARNING ?슚 Async required by heuristic for node extract_issues
2026-01-23 09:44:33,250 WARNING LLM execution attempt 1/1 failed: Resource-intensive processing required
Traceback (most recent call last):
  File "C:\Users\gimgy\OneDrive\諛뷀깢 ?붾㈃\Analemma-Os\analemma-workflow-os\backend\src\test_workflows\run_complex_analysis_test.py", line 222, in test_llm_runner
    result = llm_chat_runner(state, config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gimgy\OneDrive\諛뷀깢 ?붾㈃\Analemma-Os\analemma-workflow-os\backend\src\handlers\core\main.py", line 623, in llm_chat_runner
    raise AsyncLLMRequiredException("Resource-intensive processing required")
handlers.core.main.AsyncLLMRequiredException: Resource-intensive processing required
============================================================
Complex Document Analysis Workflow - Integration Test
============================================================
Mode: MOCK

============================================================
Testing Operator Strategies
============================================================

[Test 1] list_filter - High priority vulnerabilities
  Input: 3 items
  Output: 2 high priority items
  ??PASSED

[Test 2] list_map - Extract titles
  Output: ['SQL Injection in search', 'JWT validation weakness', 'CORS too permissive']
  ??PASSED

[Test 3] list_reduce - Count
  Output: 3
  ??PASSED

[Test 4] merge_objects - Combine metadata
  Output: {'base': 'data', 'status': 'COMPLETE', 'version': '1.0'}
  ??PASSED

[Test 5] json_parse - Parse JSON string
  Parsed 1254 bytes
  ??PASSED

[Test 6] timestamp - Generate ISO timestamp
  Output: 2026-01-23T00:44:31.967937+00:00
  ??PASSED

[Test 7] uuid_generate
  Output: 1fba2d45-d983-4ea4-8746-0e26808bff9d
  ??PASSED

============================================================
All operator strategy tests PASSED!
============================================================

============================================================
Testing LLM Runner (MOCK_MODE=True)
============================================================

Loaded document: 5114 characters

Executing LLM node: 2. 吏?μ쟻 ?듭떖 異붿텧 (Gemini Thinking Mode)
  Provider: gemini
  Model: gemini-2.0-flash
  Thinking Mode: True

  ??LLM Runner test FAILED: Resource-intensive processing required

============================================================
Testing Full Pipeline (MOCK_MODE=True)
============================================================

Workflow: complex_document_analysis_workflow
Nodes: 17
Edges: 17

[1/17] Executing: start (operator_official)
  Strategy: timestamp -> workflow_start_time

[2/17] Executing: hydrate_document (operator_official)
  Strategy: default_value -> hydrated_document

[3/17] Executing: validate_document (operator_official)
  Strategy: if_else -> document_status

[4/17] Executing: extract_issues (llm_chat)
  [MOCK] Generated mock LLM response

[5/17] Executing: parse_analysis (operator_official)
  Strategy: json_parse -> analysis_data

[6/17] Executing: filter_high_priority_vulns (operator_official)
  Strategy: list_filter -> high_priority_vulnerabilities

[7/17] Executing: filter_high_priority_opts (operator_official)
  Strategy: list_filter -> high_priority_optimizations

[8/17] Executing: format_vuln_dates (operator_official)
  Strategy: list_map -> vuln_dates_extracted

[9/17] Executing: count_high_priority (operator_official)
  Strategy: merge_objects -> filter_metadata

[10/17] Executing: prepare_subgraph_input (operator_official)
  Strategy: list_concat -> items_for_deep_analysis

[11/17] Executing: deep_analysis_subgraph (for_each)
  [MOCK] for_each processed 2 items

[12/17] Executing: aggregate_analysis (operator_official)
  Strategy: list_reduce -> analyzed_items_count

[13/17] Executing: build_final_report (operator_official)
  Strategy: merge_objects -> report_metadata

[14/17] Executing: format_markdown_report (llm_chat)
  [MOCK] Generated mock LLM response

[15/17] Executing: add_timestamp (operator_official)
  Strategy: timestamp -> workflow_end_time

[16/17] Executing: calculate_duration (operator_official)
  Strategy: uuid_generate -> execution_id

[17/17] Executing: finalize (operator_official)
  Strategy: merge_objects -> final_status

============================================================
Pipeline Execution Complete
  Nodes executed: 17/17
  Final state keys: ['document_content', 'step_history', 'workflow_start_time', 'hydrated_document', 'document_status', 'llm_analysis_raw', 'analysis_data', 'high_priority_vulnerabilities', 'high_priority_optimizations', 'vuln_dates_extracted', 'filter_metadata', 'items_for_deep_analysis', 'deep_analysis_results', 'analyzed_items_count', 'report_metadata', 'final_markdown_report', 'workflow_end_time', 'execution_id', 'final_status']
============================================================

============================================================
All tests completed!
============================================================
