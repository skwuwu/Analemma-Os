{
    "workflow_name": "Dynamic Loop Limit Test - 30 Iterations",
    "description": "Tests dynamic loop limit calculation: 3 nodes × 30 iterations = 90 weighted executions",
    "nodes": [
        {
            "id": "prep",
            "type": "sets",
            "label": "Test Preparation",
            "config": {
                "sets": [
                    {"key": "test_started", "value": true},
                    {"key": "counter", "value": 0},
                    {"key": "loop_items", "value": [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29]}
                ]
            }
        },
        {
            "id": "heavy_loop",
            "type": "for_each",
            "label": "Heavy Loop - 30 Iterations × 3 Nodes",
            "config": {
                "input_list_key": "loop_items",
                "max_iterations": 30,
                "output_key": "loop_results",
                "sub_workflow": {
                    "nodes": [
                        {
                            "id": "loop_node_1",
                            "type": "sets",
                            "config": {
                                "sets": [{"key": "step_1_done", "value": true}]
                            }
                        },
                        {
                            "id": "loop_node_2",
                            "type": "sets",
                            "config": {
                                "sets": [{"key": "step_2_done", "value": true}]
                            }
                        },
                        {
                            "id": "loop_node_3",
                            "type": "sets",
                            "config": {
                                "sets": [{"key": "step_3_done", "value": true}]
                            }
                        }
                    ],
                    "edges": [
                        {"source": "loop_node_1", "target": "loop_node_2"},
                        {"source": "loop_node_2", "target": "loop_node_3"}
                    ],
                    "start_node": "loop_node_1"
                }
            }
        },
        {
            "id": "validator",
            "type": "sets",
            "label": "Validate Dynamic Limit Calculation",
            "config": {
                "sets": [
                    {"key": "TEST_RESULT", "value": "PASS: Dynamic loop limit test completed"},
                    {"key": "test_passed", "value": true}
                ]
            }
        }
    ],
    "edges": [
        {"source": "prep", "target": "heavy_loop"},
        {"source": "heavy_loop", "target": "validator"}
    ],
    "start_node": "prep",
    "metadata": {
        "test_features": [
            "dynamic_loop_limit",
            "weighted_execution_calculation",
            "for_each_segment_counting"
        ],
        "expected_behavior": "System calculates max_loop_iterations = 90 + 20% \u2248 108+, workflow completes without LoopLimitExceeded"
    }
}
